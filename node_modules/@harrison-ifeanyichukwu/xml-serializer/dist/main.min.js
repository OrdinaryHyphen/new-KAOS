var XMLSerializer=function(){"use strict";var a=function(e){return e&&9===e.nodeType},n=function(e){return e&&1===e.nodeType},u=function(e){return e&&3===e.nodeType},l=function(e){return e&&8===e.nodeType},o=function(e){return e&&10===e.nodeType},s=function(e){return e&&11===e.nodeType},r=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e=function(){function i(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e}}(),p="http://www.w3.org/2000/xmlns/",y="http://www.w3.org/1999/xhtml",i=function(){function t(e){r(this,t),this.prefixIndex=1,this.dupPrefixDef=[],this.preserveWhiteSpace=!1!==e}return e(t,[{key:"validateXMLNameProduction",value:function(e){var t="[a-z]|[:]|[_]|[\\u00C0-\\u00D6]|[\\u00D8-\\u00F6]|[\\u00F8-\\u02FF]|[\\u0370-\\u037D]|[\\u037F-\\u1FFF]|[\\u200C-\\u200D]|[\\u2070-\\u218F]|[\\u2C00-\\u2FEF]|[\\u3001-\\uD7FF]|[\\uF900-\\uFDCF]|[\\uFDF0-\\uFFFD]|[\\uD800-\\uDBFF]|[\\uDC00-\\uDFFF]",r=new RegExp("^("+t+")([a-z]|[:]|[_]|[\\u00C0-\\u00D6]|[\\u00D8-\\u00F6]|[\\u00F8-\\u02FF]|[\\u0370-\\u037D]|[\\u037F-\\u1FFF]|[\\u200C-\\u200D]|[\\u2070-\\u218F]|[\\u2C00-\\u2FEF]|[\\u3001-\\uD7FF]|[\\uF900-\\uFDCF]|[\\uFDF0-\\uFFFD]|[\\uD800-\\uDBFF]|[\\uDC00-\\uDFFF]|[\\-]|[.]|[0-9]|\\u00B7|[\\u0300-\\u036F]|[\\u203F-\\u2040])*","i");return"string"==typeof e&&r.test(e)}},{key:"validateXMLTagName",value:function(e){return this.validateXMLNameProduction(e)&&!/^xml/i.test(e)}},{key:"validateXMLAttrName",value:function(e,t){return this.validateXMLNameProduction(e)&&("xmlns"!==e.toLowerCase()||null!==t)}},{key:"validateChar",value:function(e){var t=new RegExp("^([\\u0009]|[\\u000A]|[\\u000D]|[\\u0020-íŸ¿]|[\\uE000-\\uFFFD]|[\\uD800-\\uDBFF]|[\\uDC00-\\uDFFF])*$");return"string"==typeof e&&t.test(e)}},{key:"validateComment",value:function(e){return this.validateChar(e)&&e.indexOf("--")<0&&"-"!==e.charAt(e.length-1)}},{key:"validatePublicId",value:function(e){var t=new RegExp("^([\\u0020]|[\\u000D]|[\\u000A]|[a-zA-Z0-9]|[\\-\\'()+,./:=?;!*#@$_%])*$");return"string"==typeof e&&t.test(e)}},{key:"validateSystemId",value:function(e){return this.validateChar(e)}},{key:"validatePITarget",value:function(e){return this.validateChar(e)&&e.indexOf(":")<0&&"xml"!==e.toLowerCase()}},{key:"validatePIData",value:function(e){return this.validateChar(e)&&e.indexOf("?>")<0}},{key:"tupleExists",value:function(e,t){var r=!1,i=t.length,a=!0,n=!1,u=void 0;try{for(var l,o=e[Symbol.iterator]();!(a=(l=o.next()).done);a=!0){var s=l.value;if(i===s.length){r=!0;for(var c=-1;++c<i;)if(s[c]!==t[c]){r=!1;break}}if(r)break}}catch(e){n=!0,u=e}finally{try{!a&&o.return&&o.return()}finally{if(n)throw u}}return r}},{key:"generatePrefix",value:function(e,t){var r="ns"+this.prefixIndex++;return e[t]=r}},{key:"recordElementNSInfo",value:function(e,t,r){for(var i=null,a=e.attributes,n=-1,u=a.length;++n<u;){var l=a[n],o=l.namespaceURI,s=l.prefix;if(o===p){if(null===s){i=l.value;continue}var c=l.localName,h=l.value;void 0!==t[h]&&t[h]===c?this.dupPrefixDef.push(c):t[h]=c,r.push(c)}}return i}},{key:"serializeAttrValue",value:function(e,t){if(t&&!this.validateChar(e))throw new Error(e+" is not a valid attribute value");return null===e?"":e.replace('"',"&quot;").replace("&","&amp;").replace("<","&lt;").replace(">","&gt;")}},{key:"serializeAttributes",value:function(e,t,r,i){for(var a="",n=[],u=e.attributes,l=-1,o=u.length;++l<o;){var s=u[l],c=s.namespaceURI,h=s.localName,d=s.prefix,f=[c,h];if(i&&this.tupleExists(n,f))throw new Error("element cannot have two attributes with the same namespaceURI and localName");n.push(f);var v=c,m=null;if(null!==v){if(v===p&&(null===d&&r||null!==d&&this.dupPrefixDef.includes(h)))continue;null===d?m=null:void 0!==t[v]?m=t[v]:a+=" xmlns:"+(m=this.generatePrefix(t,v))+'="'+this.serializeAttrValue(v)+'"'}if(a+=" ",null!==m&&(a+=m+":"),i&&!this.validateXMLAttrName(h,v))throw new Error(h+" is not a valid xml attribute name");a+=h+'="'+this.serializeAttrValue(s.value)+'"'}return a}},{key:"serializeProcessingInstruction",value:function(e,t){if(t&&!this.validatePITarget(e.target))throw new Error(e.target+" is not a valid processing instruction target value");if(t&&!this.validatePIData(e.data))throw new Error(e.data+" contains invalid processing instruction character values");return"<?"+(this.preserveWhiteSpace?e.target:e.target.trim())+" "+(this.preserveWhiteSpace?e.data:e.data.trim())+"?>"}},{key:"serializeDocumentType",value:function(e,t){if(t&&!this.validatePublicId(e.publicId))throw new Error(e.publicId+" contains invalid xml document pubId character value");if(t&&!this.validateSystemId(e.systemId))throw new Error(e.systemId+" contains invalid xml document systemId character value");var r="<!DOCTYPE ",i=this.preserveWhiteSpace?e.publicId:e.publicId.trim(),a=this.preserveWhiteSpace?e.systemId:e.systemId.trim();return""===i&&""===a&&/^html$/i.test(e.name)?r+=e.name.toLowerCase():r+=e.name,""!==i&&(r+=' PUBLIC "'+i+'"'),""!==a&&""===i&&(r+=" SYSTEM"),""!==a&&(r+=' "'+a+'"'),r+=">"}},{key:"serializeDocumentFragment",value:function(e,t,r,i){for(var a="",n=e.childNodes,u=n.length,l=-1;++l<u;)a+=this.runSerialization(n[l],t,r,i);return a}},{key:"serializeText",value:function(e,t){if(t&&!this.validateChar(e.data))throw new Error(e.data+" is not a valid xml text data");return(this.preserveWhiteSpace?e.data:e.data.trim()).replace(/\&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}},{key:"serializeComment",value:function(e,t){if(t&&!this.validateComment(e.data))throw new Error(e.data+" is not a valid xml comment data");return"\x3c!--"+e.data+"--\x3e"}},{key:"serializeDocument",value:function(e,t,r,i){if(i&&null===e.documentElement)throw new Error("document has no document element root");for(var a='<?xml version="1.0" encoding="'+e.characterSet+'"?>',n=e.childNodes,u=n.length,l=-1;++l<u;)a+=this.runSerialization(n[l],t,r,i);return a}},{key:"serializeElement",value:function(e,t,r,i){var a=e.localName;if(i&&!this.validateXMLTagName(a))throw new Error(a+" is not a valid xml element local name");var n="<",u="",l=!1,o=!1,s=Object.assign(Object.create(null),r),c=[];this.dupPrefixDef=[];var h=this.recordElementNSInfo(e,s,c,this.dupPrefixDef),d=t,f=e.namespaceURI;if(d===f)null!==h&&(o=!0),n+=u="http://www.w3.org/XML/1998/namespace"===f?"xml:"+a:a;else{var v=e.prefix,m=void 0!==s[f]?s[f]:null;null!==m?(null!==h&&(d=f),n+=u=m+":"+a):null!==v&&null===h?(c.includes(v)?v=this.generatePrefix(s,f):s[f]=v,n+=u=v+":"+a,n+=" xmlns:"+v+'="'+this.serializeAttrValue(f,i)+'"'):null===h||h!==f?(o=!0,d=f,n+=u=a,n+=' xmlns="'+this.serializeAttrValue(f,i)+'"'):(d=f,n+=u=a)}if(n+=this.serializeAttributes(e,s,o,i),f===y&&!e.hasChildNodes()&&/^(area|base|basefont|bgsound|br|col|embed|frame|hr|img|input|keygen|link|menuitem|meta|param|source|track|wbr)$/i.test(a)&&(n+=" /",l=!0),f===y||e.hasChildNodes()||(n+="/",l=!0),n+=">",l)return n;if(f===y&&"template"===a.toLowerCase())n+=this.runSerialization(e.content,d,s,i);else for(var p=e.childNodes.length,F=-1;++F<p;)n+=this.runSerialization(e.childNodes[F],d,s,i);return n+="</"+u+">"}},{key:"runSerialization",value:function(e,t,r,i){return n(e)?this.serializeElement(e,t,r,i):a(e)?this.serializeDocument(e,t,r,i):l(e)?this.serializeComment(e,i):u(e)?this.serializeText(e,i):s(e)?this.serializeDocumentFragment(e,t,r,i):o(e)?this.serializeDocumentType(e,i):this.serializeProcessingInstruction(e,i)}},{key:"serializeToString",value:function(e,t){var r=Object.create(null);return r[p]="xmlns",this.prefixIndex=1,t=!!t,this.runSerialization(e,null,r,t)}}]),t}();return function(){function t(e){r(this,t),this.serializer=new i(e)}return e(t,[{key:"serializeToString",value:function(e,t){return this.serializer.serializeToString(e,t)}},{key:Symbol.toStringTag,get:function(){return"XMLSerializer"}}]),t}()}();
//# sourceMappingURL=main.min.js.map
